<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="filename" content="card_deck_pro.html">
    <title>Card Deck Pro - Pixso AI Assistant</title>
    <!-- Google Fonts: Inter & Outfit -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Outfit:wght@400;600&display=swap" rel="stylesheet">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#FF6B6B',
                        secondary: '#4ECDC4',
                        background: '#F8FAFC',
                        accent: '#FFE66D',
                        dark: '#2D3436'
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        outfit: ['Outfit', 'sans-serif'],
                    },
                    boxShadow: {
                        'premium': '0 10px 30px -5px rgba(0, 0, 0, 0.05), 0 4px 10px -5px rgba(0, 0, 0, 0.02)',
                        'card-hover': '0 20px 40px -10px rgba(255, 107, 107, 0.2)',
                    }
                }
            }
        }
    </script>
    <style>
        body { background-color: #111; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; overflow: hidden; }
        
        /* Device Frame Simulation */
        .iphone-frame {
            width: 375px;
            height: 812px;
            background: #F8FAFC;
            border-radius: 40px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 50px 100px -20px rgba(0,0,0,0.5);
            border: 8px solid #222;
        }

        .notch {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 160px;
            height: 30px;
            background: #222;
            border-bottom-left-radius: 18px;
            border-bottom-right-radius: 18px;
            z-index: 100;
        }

        /* Pull to refresh simulation */
        .refresh-indicator {
            height: 0;
            overflow: hidden;
            transition: height 0.3s ease;
            background: #f1f5f9;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Transitions */
        .page {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease;
            background: #F8FAFC;
            display: none;
        }

        .page.active { display: block; }
        .page-enter { transform: translateX(100%); }
        .page-exit { transform: translateX(-100%); }

        .custom-scrollbar::-webkit-scrollbar { width: 0px; }
        
        .card-pop { transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .card-pop:active { transform: scale(0.95); }

        .shimmer {
            background: linear-gradient(90deg, #f0f0f0 25%, #f8f8f8 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }
        @keyframes shimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }

        /* Icon Picker Grid */
        .icon-option { transition: all 0.2s ease; border: 2px solid transparent; }
        .icon-option.selected { border-color: #FF6B6B; background: #FFF0F0; transform: scale(1.1); }
    </style>
</head>
<body>

    <div class="iphone-frame">
        <div class="notch"></div>

        <!-- PAGE 1: MAIN INTERFACE -->
        <div id="page-main" class="page active flex flex-col pt-10">
            <!-- Header -->
            <header class="px-6 py-4 flex justify-between items-center bg-white/80 backdrop-blur-md sticky top-0 z-20">
                <div class="flex flex-col">
                    <span class="text-xs text-slate-400 font-medium tracking-wide uppercase">Welcome Back</span>
                    <h1 class="text-xl font-bold text-slate-800" id="greeting">晚上好，玩家！</h1>
                </div>
                <div class="w-10 h-10 rounded-full border-2 border-white shadow-md overflow-hidden bg-slate-200">
                    <img src="https://picsum.photos/id/64/100/100" alt="Avatar">
                </div>
            </header>

            <!-- Scrollable Content -->
            <div class="flex-1 overflow-y-auto custom-scrollbar px-6 pb-24" id="main-content">
                <div class="refresh-indicator text-slate-400" id="refresh-ui">
                    <i data-lucide="refresh-cw" class="w-5 h-5 animate-spin"></i>
                </div>
                
                <h2 class="text-sm font-semibold text-slate-400 mt-6 mb-4 flex items-center">
                    <i data-lucide="layers" class="w-4 h-4 mr-2"></i> 我的卡组
                </h2>

                <!-- Deck Grid -->
                <div class="grid grid-cols-2 gap-4" id="deck-grid">
                    <!-- Sample Decks -->
                    <div class="card-pop bg-white p-5 rounded-3xl shadow-premium border border-white flex flex-col items-center justify-center cursor-pointer" onclick="navigateTo('page-deck-detail', '陈述类')">
                        <div class="w-14 h-14 bg-red-50 rounded-2xl flex items-center justify-center mb-3">
                            <i data-lucide="message-circle" class="text-red-400 w-8 h-8"></i>
                        </div>
                        <span class="font-bold text-slate-700">陈述类</span>
                        <span class="text-[10px] text-slate-400 mt-1">12 张卡牌</span>
                    </div>

                    <div class="card-pop bg-white p-5 rounded-3xl shadow-premium border border-white flex flex-col items-center justify-center cursor-pointer" onclick="navigateTo('page-deck-detail', '动作类')">
                        <div class="w-14 h-14 bg-blue-50 rounded-2xl flex items-center justify-center mb-3">
                            <i data-lucide="Zap" class="text-blue-400 w-8 h-8"></i>
                        </div>
                        <span class="font-bold text-slate-700">动作类</span>
                        <span class="text-[10px] text-slate-400 mt-1">8 张卡牌</span>
                    </div>
                </div>
            </div>

            <!-- FAB Button -->
            <button onclick="navigateTo('page-new-deck')" class="absolute bottom-8 right-6 w-14 h-14 bg-gradient-to-br from-primary to-orange-400 text-white rounded-full shadow-lg shadow-primary/30 flex items-center justify-center card-pop z-30">
                <i data-lucide="plus" class="w-8 h-8"></i>
            </button>
        </div>

        <!-- PAGE 2: NEW DECK INTERFACE -->
        <div id="page-new-deck" class="page flex flex-col pt-10">
            <header class="px-4 py-4 flex items-center">
                <button onclick="goBack()" class="p-2 hover:bg-slate-100 rounded-full transition-colors">
                    <i data-lucide="chevron-left" class="w-6 h-6 text-slate-600"></i>
                </button>
                <h1 class="text-lg font-bold text-slate-800 ml-2">新建卡组</h1>
            </header>

            <div class="flex-1 px-6 pt-4 space-y-6">
                <!-- Name Input -->
                <div class="space-y-2">
                    <label class="text-xs font-bold text-slate-400 uppercase ml-1">卡组名称</label>
                    <input type="text" id="deck-name-input" oninput="validateForm()" placeholder="请输入卡组名称（必填）" 
                           class="w-full h-14 px-5 rounded-2xl bg-white border-2 border-transparent focus:border-primary focus:outline-none transition-all shadow-sm">
                </div>

                <!-- Icon Selection -->
                <div class="space-y-3">
                    <label class="text-xs font-bold text-slate-400 uppercase ml-1">选择图标</label>
                    <div class="bg-white p-4 rounded-3xl shadow-sm border-2 border-white">
                        <div class="grid grid-cols-4 gap-4" id="icon-picker">
                            <!-- Icons added by JS -->
                        </div>
                    </div>
                </div>

                <!-- Description Input -->
                <div class="space-y-2">
                    <label class="text-xs font-bold text-slate-400 uppercase ml-1">卡组描述</label>
                    <textarea id="deck-desc-input" placeholder="选填，描述一下这个卡组的用途吧~" rows="4" 
                              class="w-full px-5 py-4 rounded-2xl bg-white border-2 border-transparent focus:border-primary focus:outline-none transition-all shadow-sm resize-none"></textarea>
                </div>
            </div>

            <!-- Bottom Action Bar -->
            <div class="p-6 bg-white/80 backdrop-blur-md border-t border-slate-100">
                <button id="create-deck-btn" disabled onclick="createDeck()" class="w-full h-14 bg-slate-200 text-slate-400 font-bold rounded-2xl transition-all cursor-not-allowed">
                    创建卡组
                </button>
            </div>
        </div>

        <!-- PAGE 3: DECK DETAIL -->
        <div id="page-deck-detail" class="page flex flex-col pt-10 bg-[#F1F5F9]">
            <header class="px-4 py-4 flex items-center justify-between">
                <div class="flex items-center">
                    <button onclick="goBack()" class="p-2 hover:bg-slate-200/50 rounded-full transition-colors text-slate-600">
                        <i data-lucide="chevron-left" class="w-6 h-6"></i>
                    </button>
                    <h1 class="text-lg font-bold text-slate-800 ml-1" id="deck-detail-title">卡组详情</h1>
                </div>
                <button onclick="openModal()" class="text-primary font-bold text-sm px-4 py-2 hover:bg-primary/5 rounded-xl transition-all">
                    新建卡牌
                </button>
            </header>

            <div class="flex-1 overflow-y-auto px-4 pb-20 custom-scrollbar">
                <!-- Card Waterfall Layout -->
                <div class="grid grid-cols-2 gap-3 pb-6" id="cards-container">
                    <!-- Cards will be injected here -->
                </div>
            </div>
        </div>

        <!-- MODAL: NEW CARD MODAL -->
        <div id="modal-container" class="hidden absolute top-0 left-0 w-full h-full z-50">
            <div class="absolute inset-0 bg-black/50 backdrop-blur-sm transition-opacity" onclick="closeModal()"></div>
            <!-- Modal Content -->
            <div id="modal-content" class="absolute bottom-0 left-0 w-full bg-white rounded-t-[40px] p-8 transform translate-y-full transition-transform duration-300 shadow-2xl">
                <div class="w-12 h-1.5 bg-slate-200 rounded-full mx-auto mb-6"></div>
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-bold text-slate-800">新建卡牌</h3>
                    <button onclick="closeModal()" class="w-10 h-10 flex items-center justify-center bg-slate-100 rounded-full text-slate-400">
                        <i data-lucide="x" class="w-5 h-5"></i>
                    </button>
                </div>

                <div class="space-y-4 mb-8">
                    <div class="relative">
                        <textarea id="card-content-input" oninput="updateWordCount()" maxlength="20" placeholder="输入卡牌内容，不超过20字" 
                                  class="w-full h-32 px-5 py-4 rounded-3xl bg-slate-50 border-2 border-transparent focus:border-primary focus:outline-none transition-all text-center flex items-center justify-center text-slate-700 text-lg leading-relaxed resize-none"></textarea>
                        <div id="char-count" class="absolute bottom-4 right-5 text-xs text-slate-400 font-mono">0/20</div>
                    </div>
                </div>

                <div class="flex gap-4">
                    <button onclick="closeModal()" class="flex-1 h-14 rounded-2xl border-2 border-slate-100 font-bold text-slate-500 hover:bg-slate-50 transition-all">
                        取消
                    </button>
                    <button id="confirm-card-btn" disabled onclick="addCard()" class="flex-1 h-14 rounded-2xl bg-primary text-white font-bold shadow-lg shadow-primary/20 bg-slate-200 cursor-not-allowed">
                        确认
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // State Management
        let pageStack = ['page-main'];
        let selectedIcon = 'sparkles';
        let currentDeckCards = [];
        let timerId = null;

        const iconList = ['sparkles', 'heart', 'star', 'flame', 'moon', 'trophy', 'ghost', 'music'];

        // Initial Initialization
        function init() {
            lucide.createIcons();
            initIconPicker();
            setGreeting();
        }

        function setGreeting() {
            const hour = new Date().getHours();
            const g = document.getElementById('greeting');
            if (hour < 12) g.innerText = "早上好，玩家！";
            else if (hour < 18) g.innerText = "下午好，玩家！";
            else g.innerText = "晚上好，玩家！";
        }

        // Navigation
        function navigateTo(pageId, extra = null) {
            const currentPage = document.getElementById(pageStack[pageStack.length - 1]);
            const nextPage = document.getElementById(pageId);

            if (pageId === 'page-deck-detail') {
                document.getElementById('deck-detail-title').innerText = extra || "卡组详情";
                renderCards();
            }

            currentPage.classList.remove('active');
            nextPage.classList.add('active');
            pageStack.push(pageId);
        }

        function goBack() {
            if (pageStack.length <= 1) return;
            const currentId = pageStack.pop();
            const prevId = pageStack[pageStack.length - 1];
            
            document.getElementById(currentId).classList.remove('active');
            document.getElementById(prevId).classList.add('active');
        }

        // Icon Picker
        function initIconPicker() {
            const picker = document.getElementById('icon-picker');
            iconList.forEach(icon => {
                const div = document.createElement('div');
                div.className = `icon-option aspect-square bg-slate-50 rounded-2xl flex items-center justify-center cursor-pointer ${icon === 'sparkles' ? 'selected' : ''}`;
                div.innerHTML = `<i data-lucide="${icon}" class="w-6 h-6 text-slate-600"></i>`;
                div.onclick = () => selectIcon(icon, div);
                picker.appendChild(div);
            });
            lucide.createIcons();
        }

        function selectIcon(icon, el) {
            document.querySelectorAll('.icon-option').forEach(opt => opt.classList.remove('selected'));
            el.classList.add('selected');
            selectedIcon = icon;
        }

        // Validation
        function validateForm() {
            const nameInput = document.getElementById('deck-name-input');
            const btn = document.getElementById('create-deck-btn');
            if (nameInput.value.trim().length > 0) {
                btn.disabled = false;
                btn.className = "w-full h-14 bg-primary text-white font-bold rounded-2xl transition-all shadow-lg shadow-primary/20 transform active:scale-95";
            } else {
                btn.disabled = true;
                btn.className = "w-full h-14 bg-slate-200 text-slate-400 font-bold rounded-2xl transition-all cursor-not-allowed";
            }
        }

        // Create Deck
        function createDeck() {
            const name = document.getElementById('deck-name-input').value;
            const grid = document.getElementById('deck-grid');
            
            const newCard = document.createElement('div');
            newCard.className = "card-pop bg-white p-5 rounded-3xl shadow-premium border border-white flex flex-col items-center justify-center cursor-pointer opacity-0 translate-y-4 transition-all";
            newCard.onclick = () => navigateTo('page-deck-detail', name);
            newCard.innerHTML = `
                <div class="w-14 h-14 bg-slate-50 rounded-2xl flex items-center justify-center mb-3">
                    <i data-lucide="${selectedIcon}" class="text-primary w-8 h-8"></i>
                </div>
                <span class="font-bold text-slate-700">${name}</span>
                <span class="text-[10px] text-slate-400 mt-1">0 张卡牌</span>
            `;
            
            grid.insertBefore(newCard, grid.firstChild);
            lucide.createIcons();
            
            // Animation for entry
            if(timerId) clearTimeout(timerId);
            timerId = setTimeout(() => {
                newCard.classList.remove('opacity-0', 'translate-y-4');
                navigateTo('page-deck-detail', name);
                // Clear inputs
                document.getElementById('deck-name-input').value = "";
                validateForm();
            }, 50);
        }

        // Modal Controls
        function openModal() {
            const container = document.getElementById('modal-container');
            const content = document.getElementById('modal-content');
            container.classList.remove('hidden');
            if(timerId) clearTimeout(timerId);
            timerId = setTimeout(() => {
                content.style.transform = "translateY(0)";
            }, 10);
        }

        function closeModal() {
            const container = document.getElementById('modal-container');
            const content = document.getElementById('modal-content');
            content.style.transform = "translateY(100%)";
            if(timerId) clearTimeout(timerId);
            timerId = setTimeout(() => {
                container.classList.add('hidden');
                document.getElementById('card-content-input').value = "";
                updateWordCount();
            }, 300);
        }

        function updateWordCount() {
            const input = document.getElementById('card-content-input');
            const count = document.getElementById('char-count');
            const btn = document.getElementById('confirm-card-btn');
            const length = input.value.length;
            count.innerText = `${length}/20`;
            
            if (length > 0) {
                btn.disabled = false;
                btn.className = "flex-1 h-14 rounded-2xl bg-primary text-white font-bold shadow-lg shadow-primary/20 transform active:scale-95";
            } else {
                btn.disabled = true;
                btn.className = "flex-1 h-14 rounded-2xl bg-slate-200 text-slate-400 font-bold cursor-not-allowed";
            }
        }

        // Render Card List (Dummy/Static)
        function renderCards() {
            const container = document.getElementById('cards-container');
            container.innerHTML = "";
            const demoCards = ["大胆发言", "挑战真话", "沉默十秒", "模仿邻座"];
            demoCards.forEach(text => createCardElement(text));
        }

        function createCardElement(text) {
            const container = document.getElementById('cards-container');
            const card = document.createElement('div');
            card.className = "bg-white h-40 rounded-3xl p-4 flex items-center justify-center text-center shadow-sm border border-slate-100 hover:scale-105 active:scale-110 transition-transform cursor-pointer";
            card.innerHTML = `<p class="font-medium text-slate-800">${text}</p>`;
            container.appendChild(card);
        }

        function addCard() {
            const text = document.getElementById('card-content-input').value;
            createCardElement(text);
            closeModal();
        }

        // Simulate Pull-to-refresh
        let touchStartY = 0;
        const mainContent = document.getElementById('main-content');
        const refreshUI = document.getElementById('refresh-ui');

        mainContent.addEventListener('touchstart', e => touchStartY = e.touches[0].pageY);
        mainContent.addEventListener('touchmove', e => {
            const dist = e.touches[0].pageY - touchStartY;
            if (dist > 0 && mainContent.scrollTop === 0) {
                refreshUI.style.height = Math.min(dist * 0.4, 80) + 'px';
            }
        });
        mainContent.addEventListener('touchend', () => {
            if(timerId) clearTimeout(timerId);
            refreshUI.style.height = '0px';
        });

        window.onload = init;
    </script>
</body>
</html>
